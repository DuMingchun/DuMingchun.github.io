<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    #box{
      border: 1px solid;
      width: 600px;
      height: 600px;
      position: relative;
    }

    dsda
    #tank{
      display: inline-block;
      font-size: 0px;
      position: fixed;
    }
    #bullet{
      display: inline-block;
      font-size: 0px;
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: #000000;
    }
  </style>
</head>
<body>
  <div id="box">
    <div>
      <span id="bullet" style="left:0px;top:0px;"></span>
      <!-- 刚开始是绑定的, 按下去的时候解绑 -->
      <span id="tank" style="left:0px;top:0px;">
        <img src="mi/milogo.png">
      </span>
    </div>
  </div>


  <script>

    var tank = document.getElementById("tank")
    var bullet = document.getElementById("bullet")
    var vx = 0;
    var vy = 0;
    var send = 0
    var v = 0.1;

    var lastTime = null;
    requestAnimationFrame(function ani(time){
      var timeDiff = 0
      if(lastTime !== null){
        timeDiff = time - lastTime;
      }
      lastTime = time;

      var factor = (vx !== 0 && vy !== 0) ? Math.SQRT1_2 : 1

      tank.style.left = parseFloat(tank.style.left) + factor * vx * timeDiff + 'px'
      tank.style.top = parseFloat(tank.style.top) + factor * vy * timeDiff + 'px'

      requestAnimationFrame(ani);
    })



    window.addEventListener('keydown', function(e){
      console.log(e.key + 'down');
      if(e.key == 'ArrowLeft'){
        vx = -v;
      }
      if(e.key == 'ArrowRight'){
        vx = v;
      }
      if(e.key == 'ArrowUp'){
        vy = -v;
      }
      if(e.key == 'ArrowDown'){
        vy = v;
      }
    })
    window.addEventListener('keyup', function(e){
      if(e.key){
        vx = 0
        vy = 0
      }
    })

  </script>
</body>
</html>
